!function(w,_){var k,V,T,l,u,Z,L,ee,a,t,s,n,o,A,te,ne,I,ae,re,ie,oe,ce,E,S,M,se,le,ue,de,q,e,r,c,p,i,h,m,g,b,y=_.addEventListener,N=_.documentElement,x=_.head,fe=w.siteprefix||"",d={chapter:!1,subchapter:!1,prev:!1,next:!1},pe="localStorage"in w&&w.localStorage,he="G-ECMX8QNF81",me=/^h[0-9]{1}$/i,ge=/(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([^&?\/]{11})/,ve=w.innerHeight,be=w.matchMedia("(prefers-color-scheme: dark)"),ye=(be.matches,navigator?navigator.userAgent:0),xe=".webp",we=/(\.(jp(e)?g|gif|bmp|png|tiff))/gi,v=!(!(ye&&(ye=ye.match(/.*\bChrome\/([0-9\.]+)|.*\bFirefox\/(\d+)\b.*/))&&(ye[1]||ye[2]&&65<=parseInt(ye[2])))&&(p=[],c=!0,(i=new Image).onload=i.onerror=function(){v=0<i.height,c=!1,PROCESS_CALLBACK_QUEUE(p,v)},i.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"));function _e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}function ke(e,t){t=t||{};var n={client_id:h,session_id:m,non_personalized_ads:!0},a=new URLSearchParams,n=(Object.assign(a,n,t),a.append("en",e),a.append("_t",Date.now()),"https://www.google-analytics.com/g/collect?v=2&tid="+he+"&"+a.toString());navigator.sendBeacon?navigator.sendBeacon(n):((t=new XMLHttpRequest).open("POST",n,!0),t.send())}function Te(){console.error.apply(console,Oe(arguments))}function Le(){}h=pe.getItem("ga_client_id")||_e(),pe.setItem("ga_client_id",h),m=sessionStorage.getItem("ga_session_id"),g=parseInt(sessionStorage.getItem("ga_last_activity")||"0"),b=18e5,T=function(){var e=Array.prototype.slice.call(arguments),t=e[0],e=e.slice(1),n=Date.now();(!m||b<n-g)&&(m=_e(),ke("session_start",{})),sessionStorage.setItem("ga_session_id",m),sessionStorage.setItem("ga_last_activity",n.toString()),g=n,"js"!==t&&("config"===t?ke("page_view",{page_location:window.location.href,page_title:document.title}):"event"===t&&ke(e[0],e[1]))},Le.prototype={on:function(e,t,n){var a;return F(e)?e.forEach(function(e){Ce(e,t,n)}):((a=this.e||(this.e={}))[e]||(a[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var a=this;function r(){a.off(e,r),t.apply(n,arguments)}return r._=t,this.on(e,r,n)},emit:function(e){for(var t=Oe(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),a=0,r=n.length;a<r;a++)n[a].fn.apply(n[a].ctx,t);return this},off:function(e,t){if(F(e))e.forEach(function(e){je(e,t,ctx)});else{var n=this.e||(this.e={}),a=n[e],r=[];if(a&&t)for(var i=0,o=a.length;i<o;i++)a[i].fn!==t&&a[i].fn._!==t&&r.push(a[i]);r.length?n[e]=r:delete n[e]}return this}};function H(){D.emit.apply(D,arguments)}var Ae,C,j,Ie,Ee,O,Se,Me,qe,Ne,He,D=new Le,Ce=function(){D.on.apply(D,arguments)},je=function(){D.off.apply(D,arguments)};function Oe(e,t){return t=t||0,Array.prototype.slice.call(e,t)}function De(e,t,n){return n=e.nextElementSibling,1<(t=t||1)?De(n,--t):n}function Fe(e,t,n){return n=e.previousElementSibling,1<(t=t||1)?Fe(n,--t):n}function Pe(e,t){G(e).insertBefore(t,e)}function ze(e,t,n){(n=De(e))?Pe(n,t):R(G(e),t)}function F(e){return e instanceof Array}function Re(e){return"string"==typeof e}function Be(e){for(;$e(e);)Xe($e(e))}function P(e,t,n,a){a=(a=a||document).createElement(e);return t&&Q(a,t),Ue(a,n),a}function z(e,t,n){return e?(e=e.cloneNode(!0),t&&Q(e,t),Ue(e,n),e):0}function Ue(e,t){if(t){F(t)||(t=[t]),F(t)||(t=[t]),Ae=Ae||z(yt);for(var n=0,a=t.length;n<a;n++)if(Re(t[n]))for(Ae.innerHTML=t[n];$e(Ae);)R(e,$e(Ae));else R(e,t[n])}}function Je(e){var t=(new DOMParser).parseFromString(e,"text/html");return R(e=document.createDocumentFragment(),Oe(t.body.childNodes)),e}function R(e,t){for(var n=0,a=(t=F(t)?t:[t]).length;n<a;n++)t[n]&&(Re(t[n])&&(t[n]=ft(t[n])),e.appendChild(t[n]))}function Xe(e,t){(t=G(e))&&t.removeChild(e)}function $e(e){return e.firstChild}function Ye(e,t,n,a,r){a=B(e,function(){r||(a(),t.apply(null,arguments))},n,{passive:!0,once:!0})}function B(a,r,n,i){try{return n=n||document,-1===i&&(i={passive:!0,once:!0}),F(a)?W(a,function(e,t){B(t,r,n,i)}):W(n=F(n)||n instanceof NodeList?n:[n],function(e,t,n){if(y)n=-1!==["touchstart"].indexOf(a),t.addEventListener(a,r,n?Object.assign({passive:!0},i||{}):i||!1);else if(t.attachEvent)"DOMContentLoaded"===a&&(a="load",t=window),t.attachEvent("on"+a,r);else try{t["on"+a]=r}catch(e){}}),function(){return function n(a,r,i){i=i||_,F(a)?W(a,function(e,t){n(t,r,i)}):W(i=F(i)||i instanceof NodeList?i:[i],function(e,t){y?t.removeEventListener(a,r,!1):i.attachEvent&&t.detachEvent("on"+a,r)})}(a,r,n)}}catch(e){Te(e)}}function Qe(e,t,n,a){if(void 0===t&&(t=e?20:0),-1===e){var r=_.location.hash.split("#")[1];if(r&&!(e=_.getElementById(r)))return}a=e?e.getBoundingClientRect().top-t+w.scrollY:t,n&&"object"==typeof n||(n={behavior:"smooth"}),w.scrollTo(Object.assign({left:0,top:a},n))}function U(e,t,n,a){a=!1;for(var r=0,i=(t=F(t)?t:[t]).length;r<i;r++)if(e.classList.contains(t[r])){if(a=!0,n)return a}else if(!n)return!1;return a}function J(e,t,n){for(var a,r=0,i=(t=F(t)?t:[t]).length;r<i;r++)a=t[r],n?e.classList.remove(a):e.classList.add(a)}function F(e){return e instanceof Array}function f(e,t,n){!t&&""!==t||(e.innerHTML=t),isNaN(n)?e.removeAttribute("data-index",n):e.setAttribute("data-index",n)}function X(e,t,n){return"link"===e.type&&e.chapterTitle?e.chapterTitle:(n=e.chapterTitle||e.innerHTML,!1!==t&&e.chapterIndex?e.chapterIndex+" "+n:n)}function Ge(e,t){return t=!!e&&parseInt(e.getAttribute("data-index")),!isNaN(t)&&t}function Ke(e,t){var n;$(!1),e="object"==typeof e?Ge(e):e,isNaN(e)||!1===e||(Ee&&clearTimeout(Ee),O&&(O(),O=!1),t=L[e],(e=(Z=t).readerInfo)&&e.expand&&(n=K(e.expand))&&(bt(n,!0),e.expand=!1),Ve(t),V=!0,O=B("scroll",function(e){Ee&&clearTimeout(Ee),Ee=setTimeout(function(){V=!1,O(),O=!1},1e3)},w),Qe(t,80),n=t.chapterTitleText||t.innerText,w.history&&w.history.pushState("",n,_.location.pathname+"#"+t.id),_.title=n)}function We(){var a=null,r=Number.MAX_VALUE;L.forEach(function(e){var t=e.getBoundingClientRect(),n=window.innerHeight-t.bottom;t.top<window.innerHeight&&n<r&&(a=e,r=n)}),Ve(a)}function Ve(s){Se&&clearTimeout(Se),Se=setTimeout(function(){s?(l=L.slice(L.indexOf(s)+1).shift(),u=L.slice(0,L.indexOf(s)).pop(),n=s.classList.contains("subchapter")||"link"===s.type||s.readerInfo&&s.readerInfo.subchapter?(t=s,e=L.lastIndexOf(t),L.slice(0,e).filter(function(e){return!(!e.readerInfo||!e.readerInfo.chapter)||e.classList.contains("chapter")}).pop()):s):u=l=!1,n&&(a=n.id),t&&(r=t.id),u&&(i=u.id),l&&(o=l.id);var t,e,n,a,r,i,o,c=(c=t?t.index:!!n&&n.index)&&parseInt(c);requestAnimationFrame(function(){de.forEach(function(e,t){t=parseInt(e.getAttribute("data-index")),c===t?e.parentElement.classList.add("active"):e.parentElement.classList.remove("active")})}),d.chapter===a&&d.subchapter===r&&d.prev===i&&d.next===o||(d.chapter=!!n&&n.id,d.subchapter=!!t&&t.id,d.prev=!!u&&u.id,d.next=!!l&&l.id,requestAnimationFrame(function(){var e;n?(f(oe,X(n),n.index),t?(f(ce,X(t),t.index),ie.classList.remove("no-subchapter")):(f(ce),ie.classList.add("no-subchapter"))):(oe.innerHTML=ae,f(oe,ae),f(ce),ie.classList.add("no-subchapter"),l=L[0]),u?(S.setAttribute("title",u.innerText),f(S,!1,L.indexOf(u)),S.href="#"+(u.id||""),E.classList.remove("no-prev")):(f(S),S.href="#",E.classList.add("no-prev")),l?(M.setAttribute("title",l.innerText),f(M,!1,L.indexOf(l)),M.href="#"+(l.id||""),E.classList.remove("no-next"),l.classList.contains("subchapter")||"link"===l.type?(e=L.lastIndexOf(l),(e=L.slice(0,e).filter(function(e){return!(!e.readerInfo||!e.readerInfo.chapter)||e.classList.contains("chapter")}).pop()).id===d.chapter?(f(se,""),E.classList.add("same-chapter")):(f(se,X(e),e.index),E.classList.remove("same-chapter")),f(le,X(l),l.index),E.classList.remove("no-subchapter")):(f(le,""),f(se,X(l),l.index),E.classList.add("no-subchapter"),E.classList.remove("same-chapter"))):(f(M),M.href="#",E.classList.add("no-next"))}))},10)}function Ze(){Me||(Me=1,$async("/css/all.min.css").then(function(){}))}function et(e,t){e&&!qe||(qe=!e,Ie?(T("event",e?"menu_close":"menu_open",{event_category:"menu",event_label:e?"Close menu":"Open menu"}),requestAnimationFrame(function(){e?N.classList.remove("noscroll"):(Ze(),N.classList.add("noscroll")),C.style.display=e?"none":"block",j.style.display=e?"none":"block",e||K(".layer",C).scrollTo(0,0),t&&t()})):t&&t())}function tt(e){function t(){e.onclose&&e.onclose(),J(N,["noscroll","reader-win"],!0)}e=Object.assign({class:""},e),C||(C=K("#gdpr-w"),j=K("#gdpr-o")),C||((C=P("div")).id="gdpr-w",(j=P("div")).id="gdpr-o"),R(k,C),R(k,j),Ie||(Ie=!0,B("click",function(e){e.target===j&&t()},j),B("hashchange",function(e){t()},window)),Q(C,{class:"popup-w"+(e.class?" "+e.class:""),id:null}),Q(j,{class:"popup-o"+(e.class?" "+e.class:""),id:null});var n=K(".gdpr-i",C);return n&&Xe(n),J(n=z(e.el),"gdpr-i"),n.removeAttribute("id"),R(C,n),B("click",function(e){t()},K(".close",C)),it([C,j]),J(N,["noscroll","reader-win"]),{i:n,w:C,o:j}}function $(e,t,n,a){He=!1,requestAnimationFrame(function(){"lg"===e?(I.classList.toggle("show-lg"),I.classList.remove("show-index"),(n=I.classList.contains("show-lg"))&&T("event","show_languages",{event_category:"languages",event_label:"Show language menu"})):"index"===e?(I.classList.remove("show-lg"),I.classList.toggle("show-index"),(n=I.classList.contains("show-index"))&&((a=I.querySelector("li.active"))&&a.scrollIntoView({behavior:"smooth",block:"center"}),T("event","reader_show_index",{event_category:"reader_index",event_label:"Show index"}))):(I.classList.remove("show-lg"),I.classList.remove("show-index")),n&&(He=e),n&&"download_promo"!==e?_.documentElement.classList.add("reader-win"):_.documentElement.classList.remove("reader-win")})}function nt(n,e,t){e=new IntersectionObserver(function(e){W(e,function(e,t){n(t,t.target)})},e);return t&&at(t,e),e}function at(e,n,a){W(e=F(e)||e instanceof NodeList?e:[e],function(e,t){a?n.unobserve(t):n.observe(t)})}function rt(){e||(e=P("img",{class:"moon",width:1,height:1}),(starbg=new Image).src=vt(fe+"/images/stars.png",starbg,function(){ct(k,{"background-image":"url("+starbg.src+")"})}),pe.setItem("stars","1"))}function it(e,t,n){n=n||"";for(var a=0,r=(e=F(e)?e:[e]).length;a<r;a++)ct(e[a],{display:t?"none":n})}function ot(e){it(e,1)}function ct(n,e,a){W(e,function(e,t){ut(t)?n.style.removeProperty(e):n.style.setProperty(e,t,a?"":"important")})}function st(){q?(J(K("#darkswitch .dark"),"active"),J(K("#darkswitch .light"),"active",!0),T("event","dark_on",{event_category:"dark_mode",event_label:"Dark on"})):(J(K("#darkswitch .light"),"active"),J(K("#darkswitch .dark"),"active",!0),T("event","dark_off",{event_category:"dark_mode",event_label:"Dark off"}))}function lt(){r||(r=!0,console.log("dark theme"),q=!0,J(N,"dark"),dt(w.darkcss))}function ut(e){return void 0===e}async function dt(e,t){return(t=_.createElement("style")).styleSheet?t.styleSheet.cssText=e:"textContent"in t?t.textContent=e:t.appendChild(ft(e)),requestAnimationFrame(function(){R(x,t)}),t}function ft(e,t){if(!t)return document.createTextNode(e);e.textContent=t}async function pt(e,n,t,a,r,i,o,c){var s;t=Y(e,"data-z"),c=U(e,"shape"),t?((r=!!q&&Y(e,"data-zd"))&&(t=r),s=mt(e,"data-z-nowebp"),(i=(i=(s?t:vt(t,e,function(e,t){n&&n(e,t)},!0))||"SRC_EMPTY")instanceof Promise?await i||"SRC_EMPTY":i)!==e.src&&(Q(e,{src:i}),c)&&ct(e,{"shape-outside":"url("+i+")"})):(r=function(){ct(e,{"background-image":"url("+i+")"}),J(e,"anim")},a=!!n,(t=Y(e,"data-anim"))&&(i="/images/anim/"+t+".webp",a?r():(Ye("load",r,t=new Image),t.src=i)))}function ht(e,t){requestAnimationFrame(function(){pt(e,t)})}function Y(e,t){return e?e.getAttribute(t):void 0}function mt(e,t){return!!e&&e.hasAttribute(t)}function Q(n,e,t){var a;if(F(n))for(var r=0,i=n.length;r<i;r++)Q(n[r],e);else Re(e)&&(a=e,(e={})[a]=t),W(e,function(e,t){null===t?function n(a,r){F(a)?W(a,function(e,t){n(a,r)}):W(r=F(r)?r:[r],function(e,t){a.removeAttribute(t)})}(n,e):n.setAttribute(e,t)})}function gt(e,n){return F(e)?(n=[],W(e,function(e,t){n.push(gt(t))}),Promise.all(n)):new Promise(e)}function vt(n,a,r,e,t,i){return v?(i=n.replace(we,xe),a&&(a.src===i||a.webp_resolved&&a.webp_resolved===a.src?r&&requestAnimationFrame(function(){r(a.webp_error||null,n,a)}):(Ye("error",function(e,t){a.src=n,a.webp_resolved=n,a.webp_error=n,r&&r(e,n,a)},a),r&&Ye("load",function(){a.webp_resolved=i,r(!1,n,a)},a))),i):e&&c?gt(function(e){p.push(function(){e(vt(n,a,r))})}):(r&&requestAnimationFrame(function(){r(!0,n,a)}),n)}function G(e,t,n){return n=e.parentElement,1<(t=t||1)?G(n,--t):n}function K(e,n,a,r){return n=n||document,F(e)?(r=[],W(e,function(e,t){r.push(K(t,n,a))}),r):a?n.querySelectorAll(e):n.querySelector(e)}function W(e,t){if(F(e))for(var n=0,a=e.length;n<a;n++)t(n,e[n]);else for(var r in e)e.hasOwnProperty(r)&&t(r,e[r])}function bt(e,t){for(var n,a,r=e.parentElement;"BLOCKQUOTE"!==r.nodeName&&a<5;)a++,r=e.parentElement;(n="BLOCKQUOTE"===r.nodeName?r:n)&&(n.classList.add("expand"),t||Qe(n,120))}w.gdpr||(w.gdpr=function(e){e()}),Ce("dark",function(e,t,n,a){e?(q=!0,lt(),rt()):q=!1,st(),w.matchMedia("(prefers-color-scheme: dark)").matches===q?pe.removeItem("dark"):pe.setItem("dark",q?"1":"0"),J(N,"dark",!q),(n=K("#dark"))&&(n.checked=q),W(K("img[data-d],img[data-zd]",!1,!0),function(e,t){ht(t)})}),w.webprw=vt;var yt=P("div");function xt(e){if(!n){if(ut(n)&&(a=$e(z((a=K("#book-splash")).content)),ze(K("#sub-nav"),a),(e=K("[data-template]",a,!0)).length&&W(e,function(e,t,n,a){(a=K(n=Y(t,"data-template")))?R(t,z(a.content)):t.innerHTML="template not found: "+n}),o=P("a",{class:"show-print",target:"_blank"},P("img")),(e=Array.from(K("[data-z],[data-print]",!1,!0))).length?(imgs=[],W(e,function(e,t,n,a,r,i){if(a=Y(t,"data-print"),"IFRAME"===t.nodeName||a){if(!(n=Y(t,"data-z"))&&!a)return function(){console.log.apply(console,Oe(arguments))}(t,"no src");if(U(i=G(t),"video-container")?J(i,"hide-print"):(J(t,"hide-print"),i=!1),a){try{a=JSON.parse(a)}catch(e){return}(a=Re(a)?{image:a}:a).url||(a.url=n)}else{if(!(a=n.match(ge))||!a[1])return;a={url:"http://youtube.com/watch?v="+a[1],image:"https://img.youtube.com/vi/"+a[1]+"/0.jpg",classes:"youtube-print"}}r=z(o,{href:a.url}),a.classes&&J(r,a.classes),requestAnimationFrame(function(){Q(K("img",r),{src:a.image})}),ze(i||t,r)}imgs.push(t)})):imgs=e,_t(imgs),s||(s={},W(["chapter-number","chapter-block","chapter-cover"],function(e,t,n){if(!(n=K("#book-"+t,a)))return Te("#book-"+t,a);s[t]=z(n),Q(s[t],{id:null,class:"book-"+t})})),n=!1),!ne)return console.info("🖨️","wait for reader index"),Ce("reader-setup-done",xt);n=!0,J(N,"book-print"),R(t=K(".book-toc .toc",a),z(ue,{id:null})),_t(!1,t),W(L,function(e,t,n,a,r,i,o,c){i=t.readerInfo,me.test(t.nodeName)&&t.chapterIndex&&(r=i.print||{},Pe(t,o=z(s["chapter-block"])),R(o,t),(c=Fe(o))&&"HR"===c.nodeName&&J(c,"hide-print"),i.chapter?J(o,"chapter"):i.subchapter&&J(o,"subchapter"),(ut(r.newpage)||r.newpage)&&(i.chapter||r.newpage)&&J(o,"newpage"),r.cover&&(n=z(s["chapter-cover"]),/^#/.test(r.cover)&&K(r.cover)?R(n,z(K(r.cover).content)):R(n,Je(r.cover)),Pe(t,n)),ut(r.chapter)||r.chapter)&&(R(K("span",a=z(s["chapter-number"])),ft(t.chapterIndex)),Pe(t,a))}),console.info("🖨️","book print mode enabled")}}function wt(){ve=w.innerHeight,ct(N,{"--maxheight":"calc("+ve+"px - 150px)"}),H("vp")}function _t(e,t){W(ee=e||Array.from(K("img[data-z]",t||!1,!0)),function(e,t){pt(t)})}w.epubExport=function(m,e,t,g,r){return gt(function(t,e){requestAnimationFrame(function(){requestAnimationFrame(function(){requestAnimationFrame(function(d,f){function p(e){W(K("img",e,!0),function(e,t,n){n=z(f,{href:t.src.toString()}),Q(t,{src:n.href.toString()})})}function e(e,t){t=!!v,W(K("img[data-z]",e,!(v=!1)),function(e,t){pt(t),Q(t,{"data-z":null,"data-zd":null})}),v=!!t}f=P("a"),g=z(K("#main-content")),W(K("iframe,script,style,.video-container,.hide-print,.donate-big",g,!0),function(e,t){Xe(t)}),p(g),e(g),W(K("[data-reader-info],[data-reader-link]",g,!0),function(e,t){Q(t,{"data-reader-info":null,"data-reader-link":null})});var h=[];m=z(K(".book-splash")),W(K(".chapter",m,!0),function(e,t,n,a,r,i,o,c,s,l){if((n=Y(K("a",t),"href"))&&-1!==n.indexOf("#")&&(r=n.toString().trim().replace(/^\#/,"")+".xhtml",Q(K("a",t),{href:r}),a=K(n,g))){for(o=De(a=U(G(a),"book-chapter-block")?G(a):a),R(i=P("div"),a);o&&!U(o,"chapter");)(U(o,"subchapter")||U(o,"reader-link"))&&(s=o.id,s=K(".subchapter",o)?K(".subchapter",o).id:s)&&(l=K('a[href*="#'+s+'"]',m))&&Q(l,{href:r+"#"+s}),c=De(o),R(i,o),o=c;var u;p(i),a=i,u=r,W(K('a.chapter-link,a[href*="'+_.location.pathname.split("#")[0]+'#"],a[href^="#"]',a,!0),function(e,t){if(U(t,"chapter-link")){var n=Y(t,"data-chapter-id");if(!K("#"+n))return;t.href="#"+n}d=z(f,{href:t.href}),Q(t,{href:u+"#"+t.href.split("#")[1]})}),h.push({title:K("span.text",t).innerHTML,content:i.innerHTML,filename:r,id:n})}}),W(K("li.active",m,!0),function(e,t){J(t,"active",!0)}),0<h.length&&(e(d=P("div",null,z(K("#footer")))),p(d),h[h.length-1].content+=d.innerHTML),W(d=K("template.epub",!(r=[]),!0),function(e,t,n,a){n=Y(t,"data-id"),r[n]=z(t.content).innerHTML}),Q(K(".reader-index",m),{id:"toc","epub:type":"toc"}),e(m),p(m),t({chapters:h,tocHTML:m.innerHTML,templates:r})})})})})},w.tocExport=function(o){return gt(function(s,i){requestAnimationFrame(function(){requestAnimationFrame(function(){requestAnimationFrame(function(e,a){try{a=P("a");var t=K(".book-splash .book-toc > h1").innerText,n=z(K(".book-splash .toc"));if(!n)throw new Error(".toc not found");if(W(K("li.active",n,!0),function(e,t){J(t,"active",!0)}),W(K("a",n,!0),function(e,t){t.href&&Q(t,{href:t.href.toString()})}),r=!!v,W(K("img[data-z]",n,!(v=!1)),function(e,t){pt(t),Q(t,{"data-z":null,"data-zd":null})}),v=!!r,W(K("img",n,!0),function(e,t,n){n=z(a,{href:t.src.toString()}),Q(t,{src:n.href.toString()})}),o){let i=[],o=null;function c(e){var t,e=K("a",e);return{title:(t=K(".text",e))?t.textContent:"",number:(t=K(".num",e,!0),Array.from(t).map(e=>e.textContent).join("").replace(/\.$/,"")),id:e.href.split("#")[1]||""}}W(K("li",n,!0),function(e,t){if(t.classList.contains("chapter"))o=c(t),i.push(o);else if(t.classList.contains("subchapter")){var n=c(t),a=(t=t.className.split(" ").find(e=>e.startsWith("l")))?parseInt(t.substring(1)):0;if(a){var r=o;o.children||(o.children=[]);let t=o.children;for(let e=2;e<a&&(r=t[t.length-1]);e++)r.children||(r.children=[]),t=r.children;t&&t.push(n)}else o&&(o.children||(o.children=[]),o.children.push(n))}}),s({title:t,toc:i})}else s({title:t,toc:n.innerHTML})}catch(e){return i(e)}var r})})})})},B(["resize","orientationchange"],function(e){wt()},w);var kt,Tt,Lt,At={scroll:!1,time:!1},It=B("scroll",function(e){At.scroll||(At.scroll=!0,It())},w);async function Et(a){if(void 0===Tt){a=a||"HEAD";let e=K("#download-links"),n=K('a[rel="A4"]',e);Tt=await new Promise((t,e)=>{fetch(n.href,{method:a}).then(async e=>{if(e.ok&&("application/pdf"===e.headers.get("Content-Type")||"application/octet-stream"===e.headers.get("Content-Type")&&1024<parseInt(e.headers.get("Content-Length")))){if("GET"===a)try{e.body.cancel()}catch(e){}t(!0)}else{if(405===e.status&&"HEAD"===a&&e.headers.get("Allow")&&e.headers.get("Allow").includes("GET"))return Et("GET");console.warn("Local PDF source down",e.status,e),t(!1)}}).catch(e=>{console.warn("Local PDF source down",e),t(!1)})})}return Tt}setTimeout(function(){},3e3),Ce("read-status",function(e){At[e]=!0}),w.resolveImgs=function(){return gt(function(e,t,n,a){var r=[];W(K("img[data-z]",!1,!0),function(e,t,n){t.webp_resolved&&!t.complete&&r.push(gt(function(t,e){Ye(["load","error"],function(e){t()},target,n)}))}),r.length?(a=setTimeout(function(){n||(n=!0,e())},1e4),Promise.all(r).then(function(){a&&clearTimeout(a),n||(n=!0,e())})):e()})};var St=[];async function Mt(){var e,t;return Lt||(e=K(".backups li[data-pdfsrc]",!1,!0),t=[],W(e,(i,o)=>{t.push((async()=>{var r,n=Y(o,"data-pdfsrc");if(n){n=JSON.parse(n),St[i]={src:n,loading:!0};let t;try{t=!1===n[0]?await Et():(r=n[0],await new Promise((a,e)=>{var t=document.createElement("script");t.src=r+"up.js",t.async=!0,t.crossOrigin="anonymous",t.onerror=()=>{a(!1)},t.onload=()=>{var e=new URL(r).hostname,t=(/gmodebate\.net/.test(e)&&(e="gmodebate.net"),new RegExp(e));if(window.pdfUp)for(var n of window.pdfUp)if(t.test(n))return a(!0);return a(!1)},document.body.appendChild(t)}))}catch(e){t=-1}let e;St[i].up=t,St[i].loading=!1,statsCode=-1===t?(e="🟡","unknown"):t?(e="🟢","up"):(e="🔴","down");var a=K(".status .e",o);a.innerHTML=e,J(a,"loading",!0),!1!==n[0]||t||ot(o)}})())}),await Promise.all(t),Lt=!0),St}w.commentSubmit=function(e){K("#comment-form").submit()},B(),-1!==document.cookie.indexOf("ebook-pdf-printer=")&&(A=!0),function e(t){"complete"===(state=_.readyState)||"interactive"===state?t():requestAnimationFrame(function(){e(t)})}(function(){var n,a,r;k=_.body,T("js",new Date),T("config",he),A&&_t(),wt(),nt(function(e,t){e.isIntersecting&&!n&&(A||($async("/css/comment.css"),function(t){if(kt)t();else{if(!1===kt)return Ce("recaptcha",function(){t()});kt=!1,$async("https://www.google.com/recaptcha/api.js?render=explicit").then(function(e){e=setInterval(function(){grecaptcha&&(kt=!0,e)&&(clearTimeout(e),grecaptcha.ready(function(){t(),H("recaptcha")}))},0)})}}(function(e){W(K("form.comment .g-recaptcha",!1,!0),function(e,t,n,a){n=Y(t,"data-sitekey"),Y(t,"data-callback"),grecaptcha.render(t,{sitekey:n,callback:function(){K("#comment-form").submit()}})})})),n=!0)},{threshold:0,rootMargin:"0px"},K("#comment-form",!1,!0)),requestAnimationFrame(function(){"#comment-form"===_.location.hash&&Qe(-1,80)});try{(q=U(N,"dark"))&&(lt(),rt()),st()}catch(e){console.error(e)}B("change",function(e){console.log("dark mode change",e.matches),H("dark",!!e.matches)},be),B("click",function(e){H("dark",!q)},K("#darkswitch > span")),A||(a=nt(function(e,t){e.isIntersecting&&(ht(t),a.unobserve(t),ee=ee.filter(function(e){return t!==e}))},{threshold:0,rootMargin:"0px"},ee=Array.from(K("[data-z],[data-anim]",!1,!0))),Ce("i",function(e){W(e=F(e)?e:[e],function(e,t){at(t,a),ee.push(t)})}),nt(function(e,t){!e.isIntersecting||A||r||(r=!0,$async("https://platform.twitter.com/widgets.js"))},{threshold:0,rootMargin:"0px"},K(".twitter-tweet",!1,!0)));var e,t,i,o,c=_.getElementById("menubtn"),s=(c&&B("click",function(e){var t=tt({el:K("#menucon"),class:"menu",onclose:function(){et(!0)}});W(K("img[data-z], [data-anim]",t.i,!0),function(e,t){ht(t)}),et()},c),K("form.donate")),l=(s&&B("submit",function(e){""==s.querySelector("input").value&&(e.preventDefault(),alert("Please enter an e-mail address..."),s.querySelector("input").focus())},s),K("#download-links")),c=(l&&((e=Y(l,"data-pdfsrc"))&&(e=JSON.parse(e),(async()=>{if((!1===e[0]||"/"===e[1].substr(0,1))&&!await Et()){let e=await Mt(),t;W(e,function(e,n){n.up&&!t&&(t=!0,console.info("PDF mirror",n.src[0]),W(K("a[data-file]",l,!0),function(e,t){Q(t,{href:n.src[1]+Y(t,"data-file"),target:"_blank",rel:"noopener"})}))}),t||console.warn("No PDF mirror available",e)}})()),function(){D.once.apply(D,arguments)}("mirrors",function(){Mt()})),K(".backups",!1,!0)),c=(c.length&&W(c,function(e,t){var n=K("a.toggle",t),a=U(t,"footer");n&&B("click",function(e){e.preventDefault(),J(t,"open"),a?requestAnimationFrame(function(){t.scrollIntoView()}):H("mirrors")},n)}),K(".video-container [data-video]",!1,!0)),c=(c.length&&(B("click",function(e,t,n,a,r){for(e.preventDefault(),n=Y(t=e.target,"data-video");t&&!n;)n=Y(t=G(t),"data-video");J(G(t),"playing"),r={width:720,height:405,src:"https://www.youtube.com/embed/"+(n=JSON.parse(Y(t,"data-video"))).id+"?autoplay=1",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:!0},a=P("iframe",r=n.attrs?Object.assign(r,n.attrs):r),G(e=t).replaceChild(a,e)},c),W(c,function(e,t,n){J(G(t),"imgplay")})),w.IntersectionObserver&&(c=K("#sub-nav"),new w.IntersectionObserver(function(e){e=e[0];e.target.classList.toggle("isSticky",e.intersectionRatio<1)},{threshold:[1],rootMargin:"-1px 0px 0px 0px"}).observe(c)),K('meta[http-equiv="content-language"]'),K("blockquote .expandlink",!1,!0)),c=(c&&c.length&&c.forEach(function(t){B("click",function(e){e.preventDefault(),bt(t)},t);var e=t.getAttribute("data-hash");e&&_.location.hash&&_.location.hash.split("#")[1]===e&&bt(t)}),K(".rightsnature")),c=(c&&(c.onclick=function(){T("event","newsletter_rightsfornature",{event_category:"newsletter",event_label:"Newsletter Rights for Nature"})}),K('a[target="_blank"]',!1,!0)),c=(c&&c.length&&B("click",function(e){T("event","ext_link",{event_category:el.classList.contains("quote")?"quote":"other",event_label:el.href})},c),K("p.donate a",!1,!0));c&&c.length&&_.getElementById("donate")&&(B("click",function(e){e.preventDefault(!0),Qe(_.getElementById("donate"),80),T("event","donate_button",{event_category:"donate",event_label:"Donate Button"})},c),K("form.donate input").onfocus=K("form.donate input").onkeypress=function(e){t&&clearTimeout(t),t=setTimeout(function(){T("event","donate_form_entry",{event_category:"donate",event_label:"Donate Form Email Entry"})},1e3)}),B(["beforeprint","afterprint"],function(e){H("print",!("afterprint"===e.type))},w);var u,c=w.matchMedia("print"),c=(B("change",function(e){H("print",!!e.matches)},c),Ce("print",function(e,t){if(e){if(A=!0,dt(`@font-face {
  font-display: swap;
  font-family: 'Noto Color Emoji';
  font-style: normal;
  font-weight: 400;
  src: local('Noto Color Emoji'), 
        url('/fonts/noto-color-emoji-v30-emoji-regular.woff2') format('woff2'),
       url('/fonts/noto-color-emoji-v30-emoji-regular.ttf') format('truetype');
}`),o)return;o=!0,xt(),i=q,H("dark",!1),console.info("🖨️","print view enabled")}else{if((A=!1)===o)return;o=!1,H("dark",q=i)}e=Array.from(K('a[href^="/"]',K("#main-content"),!0));e.length&&(imgs=[],W(e,function(e,t,n,a,r,i){A?(a=(n=Y(t,"href")).match(/^\/([^\/]+)\/(\#.*)?$/))&&a[1]!==window.articleSlug&&Q(t,{"data-href":n,href:"/download/"+a[1]+".html"}):(n=Y(t,"data-href"))&&Q(t,{href:n})}))}),c.matches&&H("print",!0),te=K("#reader"),I=K(".reader-container"),_.body.appendChild(I),ae=te.getAttribute("data-foreword"),re=te.querySelector(".index-btn"),ie=te.querySelector(".status > .cur"),oe=ie.querySelector("span.chapter"),ce=ie.querySelector("span.subchapter"),E=te.querySelector(".status > .next"),S=E.querySelector("a.prev"),M=E.querySelector("a.next"),se=E.querySelector("span.chapter"),le=E.querySelector("span.subchapter"),ue=K("#reader-index"),B("click",function(e){e.preventDefault();var t=e.target===S?"prev":"next";e.target===S&&E.classList.contains("no-prev")||e.target===M&&E.classList.contains("no-next")||(Ke(e.target),T("event","reader_"+t,{event_category:"reader_nav",event_label:t+" nav"}))},[S,M]),K(".reader-index .ebook-download")),d=(B("click",function(e,t){e.preventDefault();e=K("#download");document.location.href=e.href},[K("button",c),K("input",c)]),ebook_download_setup=!1,Array.from(K(".reader-index,.download-index",I,!0))),c=(B("click",function(e){var t=e.target;if(t){if(-1===d.indexOf(t)&&!U(t,"reader-container"))for(;t!==k;){if(U(t,"reader-container")||U(t,"popup-w"))return;if(!(t=G(t)))return}$(!1)}},k),B("click",function(e){e.preventDefault(),e.stopPropagation(),$("index"),u||(_t(),u=!0)},re),K("#select-lg")),c=(c&&B("click",function(e){e.preventDefault(),e.stopPropagation(),$("lg")},c),K("#show-social")),f=(c&&B("click",function(e){e.preventDefault(),e.stopPropagation(),Ze(),function t(n){T("event",n?"social_close":"social_open",{event_category:"social",event_label:n?"Close social share":"Open social share"}),$(!1),Ze(),requestAnimationFrame(function(){var e;n?(J(N,["noscroll","reader-win"],!0),ot([C,j])):(e=tt({el:K("#social-popup"),class:"social-popup light-o",onclose:function(){t(!0)}}),K(".layer",C).scrollTo(0,0),W(K("img[data-z], [data-anim]",e.i,!0),function(e,t){ht(t)}))})}()},c),K("#main-content")),c=(f&&B("click",function(e){for(var t=e.target;t&&"CITE"!==t.nodeName;){if(t===f||t===document.body)return;t=G(t)}t&&(e.preventDefault(),e.stopPropagation(),function d(f,p){T("event",p?"cite_close":"cite_open",{event_category:"cite",event_label:p?"Close citation":"Open citation"}),$(!1);for(var i,o,e,t=Y(f,"rel"),h=(void 0===Ne&&(e=K("#citations"),Ne=!!e&&JSON.parse(e.textContent)),{}),m=(Ne&&Ne[t]&&(h=Ne[t]),G(f));m&&"P"!==m.nodeName;)(m=G(m))===document.body&&(m=!1);h.context||((e=Y(f,"rel"))?(i=[],W(e=e.split(","),function(e,t){if("p"===t)o=!0;else{var n=t.match(/^(next|prev)(\d+)?$/);if(n){o=!0;var a=1;for(n[2]&&!isNaN(n[2])&&(a=parseInt(n[2])),e=0;e<a;e++){var r=("next"===n[1]?De:Fe)(m,e+1);r&&i.push(r.innerText)}}}o&&i.unshift(m.innerText),h.context=i.length?i.join("\n"):"chapter"})):h.context="chapter"),h.text||(h.text=Y(K("#citations"),"data-default-desc").replace("[CITE]",f.innerText)),requestAnimationFrame(function(){if(p)J(N,["noscroll","reader-win"],!0),ot([C,j]);else{var e,t=tt({el:K("#cite-popup"),class:"cite-popup light-o",onclose:function(){d(f,!0)}}),n=K(".layer",C),a=K(".desc",n);switch(n.scrollTo(0,0),Be(a),h.title&&R(a,P("h3",!1,h.title)),h.context){case"p":e=m.innerText;break;case"chapter":for(var r=Fe(m);r&&!U(r,["chapter","subchapter"],!0);)r=Fe(r);var i=[];if(r){i.push(z(r).innerText);for(var o=De(r);o&&!U(o,["chapter","subchapter"],!0);){var c,s=z(o).innerText;o.classList.contains("quote")&&(c="A"!==(c=o).nodeName?K("a",o):c)&&(s="# "+K(".title",c).innerText,s=(s+="\n"+K(".title",c).innerText)+"\n"+c.href),i.push(s),o=De(o)}}e=i.join("\n");break;default:e=h.context}h.extra_context&&(e+="\n"+h.extra_context);var l=(l=h.prompt)||(l=Y(K("#citations"),"data-default-prompt")).replace("[URL]",document.location.href).replace("[CONTEXT]",e).replace("[QUERY]",f.innerText),u=(h.extra_prompt&&(l+="\n"+h.extra_prompt),encodeURIComponent(l));R(a,P("p",{},h.text)),W(K("a",K(".buttons",n),!0),function(e,n){switch(Y(n,"data-ref")){case"chatgpt":n.href="https://chatgpt.com/?q="+u;break;case"perplexity":n.href="https://perplexity.ai/?q="+u;break;case"you":var t=h.model||"claude_3_5_sonnet";n.href="https://you.com/search?tbm=youchat&cfr=chat&chatMode="+t+"&q="+u;break;case"prompt":B("click",function(t){t.preventDefault();t=P("textarea");t.value=l,R(document.body,t),t.select();try{document.execCommand("copy"),document.body.removeChild(t),mt(n,"data-text")||Q(n,{"data-text":n.innerHTML}),n.innerHTML="✅",setTimeout(function(){n.innerHTML=Y(n,"data-text")},2e3)}catch(e){Be(a),R(a,t)}},n)}}),W(K("img[data-z], [data-anim]",t.i,!0),function(e,t){ht(t)})}})}(t))},f),K(".main")),p=[".reader-link"];if(["h1","h2","h3","h4","h5","p"].forEach(function(e){p.push(e+".chapter,"+e+".subchapter")}),U(k,"no-reader"))L=[];else{if(0===(L=Array.from(c.querySelectorAll(p.join(",")))).length){var h=1,m=c.querySelectorAll("h1.bighead");if(0===m.length&&(h=2,m=c.querySelectorAll("h2.bighead")),0===m.length&&(h=3,m=c.querySelectorAll("h3.bighead")),0<m.length){hbig=Array.from(c.querySelectorAll(".bighead")),m=Array.from(m),h1first=hbig.indexOf(m[0]);for(var g=[],v=1;v<=5;v++)v<=h||g.push("h"+v+".bighead");g.length&&(h2big=c.querySelectorAll(g.join(","))),m.forEach(function(e){e.classList.add("chapter")}),h2big.length&&(h2big=Array.from(h2big)).forEach(function(e){var t=hbig.indexOf(e);e.classList.add(t<h1first?"chapter":"subchapter")})}L=Array.from(c.querySelectorAll(p.join(",")))}B("click",function(e,t,n){for(e.preventDefault(),t=e.target;"A"!==t.nodeName;)t=t.parentElement;(n=K(t.getAttribute("data-chapter-link")))&&(Ke(n),T("event","reader_link_"+n.id,{event_category:"reader_link_selection",event_label:X(n)}))},c.querySelectorAll("[data-chapter-link]"))}if(0===L.length)J(te,"nochapters");else{var b,m=_.documentElement.getAttribute("lang");try{b=new Intl.NumberFormat(m,{minimumFractionDigits:0,maximumFractionDigits:0})}catch(e){}var y=_.createElement("li"),c=_.createElement("a"),m=_.createElement("span"),x=_.createElement("span");J(m,"num"),x.classList.add("text"),c.appendChild(m),c.appendChild(x),y.appendChild(c),requestAnimationFrame(function(){for(var t,e,n,a,r,i,o,c,s,l,u,d=[],f=0,p={},h=0,m=L.length;h<m;h++){if((tag=L[h]).id||(tag.id="_h"+h),tag.type=!1,tag.index=h,tag.setAttribute("data-index",h),u=c=s=!1,i=tag.classList.contains("chapter")?(d=[[++f,0]],o=!(r=!0)):(r=!1,o=(o=tag.getAttribute("data-level"))&&parseInt(o),tag.classList.contains("subchapter")),e=(t=y.cloneNode(!0)).querySelector("a"),n=e.querySelector("span.num"),a=e.querySelector("span.text"),tag.classList.contains("reader-link")){s=!0;try{c=JSON.parse(tag.getAttribute("data-reader-link"))}catch(e){console.error(e);continue}c.level&&(o=c.level),c.classes&&(u=c.classes instanceof Array?c.classes:[c.classes]),a.innerHTML=c.title||tag.innerHTML,c.chapter?(tag.readerInfo=c,a.innerHTML=(c.emoji?"<span class=e"+(c.emoji_anim?' data-anim="'+c.emoji_anim+'"':"")+">"+c.emoji+"</span> ":"")+(c.title||tag.innerHTML),tag.chapterTitle=a.innerHTML,o=!(r=!(s=!(d=[[++f,0]])))):c.subchapter?(i=!0,tag.readerInfo=c,a.innerHTML=(c.emoji?"<span class=e"+(c.emoji_anim?' data-anim="'+c.emoji_anim+'"':"")+">"+c.emoji+"</span> ":"")+(c.title||tag.innerHTML),tag.chapterTitle=a.innerHTML,s=!1):(t.classList.add("reader-link"),tag.readerInfo=c,tag.type="link",tag.chapterTitle=(c.emoji?"<span class=e"+(c.emoji_anim?' data-anim="'+c.emoji_anim+'"':"")+">"+c.emoji+"</span> ":"")+" "+a.innerHTML)}else{if(tag.hasAttribute("data-reader-info"))try{c=JSON.parse(tag.getAttribute("data-reader-info"))}catch(e){console.error(e);continue}c?(c.level&&(o=c.level),tag.readerInfo=c,a.innerHTML=(c.emoji?"<span class=e"+(c.emoji_anim?' data-anim="'+c.emoji_anim+'"':"")+">"+c.emoji+"</span> ":"")+(c.title||tag.innerHTML),tag.chapterTitle=a.innerHTML,c.classes&&(u=c.classes instanceof Array?c.classes:[c.classes])):(tag.chapterTitle=tag.innerHTML,a.innerHTML=tag.innerHTML)}var g=_.createElement("div");if(g.innerHTML=tag.chapterTitle,tag.chapterTitleText=tag.readerInfo&&tag.readerInfo.titleText?tag.readerInfo.titleText:g.innerText,tag.readerInfo&&tag.readerInfo.indexTitle&&(a.innerHTML=c.indexTitle),tag.readerInfo&&tag.readerInfo.emoji_anim&&(pt(K("[data-anim]",g=z(yt,null,Je(tag.chapterTitle))),!0),tag.chapterTitle=g.innerHTML),isNaN(o)||!1===o||o--,o<0&&(o=0),tag.readerInfo||(tag.readerInfo={}),tag.readerInfo.level=o,r||tag.readerInfo.chapter?tag.readerInfo.chapter=!0:(i||tag.readerInfo.subchapter)&&(tag.readerInfo.subchapter=i),r)t.classList.add("chapter"),n.innerHTML=(b?b.format(f):f)+".",tag.chapterIndex=n.innerHTML;else{if(void 0===d[o]&&(void 0===d[o-1]?(console.error("invalid parent",tag,d,o),d[o]=[-1,0]):d[o]=[d[o-1][1],0]),s)n.innerHTML="&nbsp;",J(a_num_sub=n.cloneNode(!0),"e"),a_num_sub.innerHTML=c.emoji||"📌",c.emoji&&c.emoji_anim&&Q(a_num_sub,{"data-anim":c.emoji_anim}),n.parentNode.insertBefore(a_num_sub,n.nextSibling);else{for(;d[o+1];)d.pop();d[o][1]++,l=[],d.reverse().forEach(function(e){(a_num_sub=n.cloneNode(!0)).innerHTML=(b?b.format(e[1]):e[1])+".",n.parentNode.insertBefore(a_num_sub,n.nextSibling),l.push(a_num_sub.innerHTML)}),d.reverse(),n.innerHTML=(b?b.format(d[0][0]):d[0][0])+".",l.reverse(),l.unshift(n.innerHTML),tag.chapterIndex=l.join("")}t.classList.add("subchapter"),u&&u.forEach(function(e){t.classList.add(e)}),0<o&&t.classList.add("l"+(o+1))}Q(e,{"data-index":h,href:(p[tag.id]=tag).readerInfo&&tag.readerInfo.link?tag.readerInfo.link:"#"+tag.id}),ue.appendChild(t)}imgs=Array.from(K("img[data-d],img[data-z],img[data-zd],[data-anim]",ue,!0)),H("i",imgs);var v=Array.from(K("a.chapter-link",!1,!0));W(v,function(e,t,n,a,r){n=Y(t,"data-chapter-id"),(a=p[n])&&((r=K("span",t))&&(r.innerHTML=a.chapterIndex),Q(t,{"data-index":Y(a,"data-index"),title:a.chapterTitleText}))}),de=Array.from(ue.querySelectorAll("[data-index]")),_.location.hash&&function(){var n;try{if(!(n=K(_.location.hash.toString())))return;var e=Ge(n);if(isNaN(e)||!1===e)return;n=L[e]}catch(e){return console.error("hash",e)}function t(){var e,t=n.readerInfo;t&&t.expand&&(e=K(t.expand))&&(bt(e,!0),t.expand=!1),Qe(n,80,{})}_t();e=n.chapterTitleText||n.innerText;w.history&&w.history.replaceState("",e,_.location.pathname+"#"+n.id),_.title=e,t(),requestAnimationFrame(function(){t()}),setTimeout(function(){t()},1e3)}(),v.length&&B("click",function(e){for(var t=e.target;!t.classList.contains("chapter-link")&&"A"!==t.tagName;)t=t.parentElement;var n=Ge(t);isNaN(n)||!1===n||(e.preventDefault(),e=L[n],Ke(t),T("event","reader_chapter_link_"+e.id,{event_category:"reader_chapter_link",event_label:X(e)}))},v),B("click",function(e){e.preventDefault();for(var t=e.target;!t.classList.contains("reader-link")&&"A"!==t.tagName;)t=t.parentElement;var n,e=Ge(t);isNaN(e)||!1===e||((n=(e=L[e]).readerInfo)&&n.link?n.target&&"_blank"===n.target?w.open(n.link):_.location.href=n.link:(Ke(t),T("event","reader_index_"+e.id,{event_category:"reader_index_selection",event_label:X(e)})))},de),ne=!0,H("reader-setup-done")}),B("scroll",function(){var e=w.scrollY/(k.offsetHeight-w.innerHeight)*100;requestAnimationFrame(function(){ct(te,{"border-image-source":"linear-gradient(to right, var(--readerbarfill) "+e+"%, var(--readerbar) 0%)"})}),V||We()},window),B("wheel",function(e){Ee&&clearTimeout(Ee),O&&O(),V=!1},window),B("keydown",function(e){if(He){if("Escape"===event.key)return $(!1);var t;"index"===He&&(t=ue.parentElement,"ArrowUp"===event.key?t.scrollTop-=50:"ArrowDown"===event.key&&(t.scrollTop+=50))}},_),We(),B("keydown",function(e){if(-1!==["INPUT","TEXTAREA","SELECT"].indexOf(e.target.tagName)||e.altKey||e.ctrlKey)return!1;var t;37==e.keyCode?w.pageXOffset<=0&&(e.preventDefault(),0===(t=Ge(S))&&Z&&Ge(Z)===t?(Qe(),Z=!1):Ke(S)):39==e.keyCode&&_.body.scrollWidth-w.innerWidth<=w.pageXOffset&&(e.preventDefault(),Ke(M))},_)}A&&xt(),"#print"===_.location.hash&&$("download",0,!0)})}(window,document);